@inject NavigationManager NavigationManager
@inject IApiClientFactory ApiClientFactory
@inject IHttpClientFactory HttpClientFactory

<DxGrid Data="OpexDataSource" ShowSearchBox="true" SearchBoxNullText="Arama yapmak için metin girin…" style="height:100%;">
    <Columns>
        <DxGridDataColumn FieldName="UnitCode" Caption="Alt Kurum Kodu" />
        <DxGridDataColumn FieldName="UnitName" Caption="Alt Kurum Adý" />
        <DxGridDataColumn FieldName="StockCode" Caption="Stok Kodu" />
        <DxGridDataColumn FieldName="StockName" Caption="Stok Adý" />
        <DxGridDataColumn FieldName="Quantity" Caption="Miktar" DisplayFormat="n2" />
        <DxGridDataColumn FieldName="UnitPrice" Caption="Tahmini Maliyet Fiyatý" DisplayFormat="n4" />
        <DxGridDataColumn FieldName="Currency" Caption="Para Birimi" />
    </Columns>
</DxGrid>


@code {
    private GridDevExtremeDataSource<TenderOpexModel>? OpexDataSource { get; set; }

    [Parameter]
    public int TenderId { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var client = await ApiClientFactory.CreateAsync(HttpClientFactory.CreateClient("ApiClient"));
        string baseUrl = "https://localhost:7071/api";
        OpexDataSource = new GridDevExtremeDataSource<TenderOpexModel>(client, NavigationManager.ToAbsoluteUri($"{baseUrl}/tender-opex?tenderId={TenderId}"));
    }
}
